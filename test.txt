Кажется, все работает! Криво, но работает..